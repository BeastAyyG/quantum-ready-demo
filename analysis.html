<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuantumReady ‚Äî Amul Milk Coliform Analysis | Quantum Use Case</title>
    <meta name="description"
        content="Live coliform contamination analysis of Amul milk samples with quantum computing readiness assessment for dairy pathogen detection.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        /* ===== ANALYSIS PAGE SPECIFIC ===== */
        .analysis-page {
            padding: 100px 2rem 4rem;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .page-header h1 {
            font-size: clamp(1.75rem, 3vw, 2.5rem);
            font-weight: 800;
            letter-spacing: -0.03em;
            margin-bottom: 0.75rem;
        }

        .page-header p {
            color: var(--text-secondary);
            font-size: 1.05rem;
            max-width: 700px;
            margin: 0 auto;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 2rem;
            transition: var(--transition);
        }

        .back-link:hover {
            color: var(--text-primary);
        }

        /* KPI Row */
        .kpi-row {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            text-align: center;
            transition: var(--transition);
        }

        .kpi-card:hover {
            border-color: var(--border-hover);
            background: var(--bg-card-hover);
        }

        .kpi-value {
            font-size: 1.75rem;
            font-weight: 800;
            font-family: var(--font-mono);
            margin-bottom: 0.25rem;
        }

        .kpi-value.danger {
            color: var(--accent-red);
        }

        .kpi-value.warning {
            color: var(--accent-amber);
        }

        .kpi-value.success {
            color: var(--accent-green);
        }

        .kpi-value.info {
            color: var(--accent-cyan);
        }

        .kpi-value.purple {
            color: var(--accent-purple);
        }

        .kpi-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Chart Grid */
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: var(--transition);
        }

        .chart-card:hover {
            border-color: var(--border-hover);
        }

        .chart-card.full-width {
            grid-column: 1 / -1;
        }

        .chart-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chart-header h3 {
            font-size: 0.95rem;
            font-weight: 700;
        }

        .chart-header .chart-badge {
            font-size: 0.7rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 100px;
            background: rgba(139, 92, 246, 0.1);
            color: var(--accent-purple);
            border: 1px solid rgba(139, 92, 246, 0.2);
        }

        .chart-body {
            padding: 1.5rem;
            position: relative;
        }

        .chart-body canvas {
            max-height: 300px;
        }

        /* Data Table */
        .data-table-container {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .table-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header h3 {
            font-size: 0.95rem;
            font-weight: 700;
        }

        .table-controls {
            display: flex;
            gap: 0.75rem;
        }

        .table-filter {
            padding: 0.375rem 0.75rem;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-family: var(--font-sans);
            font-size: 0.8rem;
        }

        .table-filter option {
            background: var(--bg-secondary);
        }

        .table-scroll {
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8rem;
        }

        .data-table th {
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.7rem;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
            z-index: 1;
        }

        .data-table td {
            padding: 0.625rem 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.03);
            color: var(--text-secondary);
            font-family: var(--font-mono);
            font-size: 0.75rem;
            white-space: nowrap;
        }

        .data-table tr:hover td {
            background: rgba(255, 255, 255, 0.02);
        }

        .badge-pass {
            display: inline-block;
            padding: 0.15rem 0.5rem;
            border-radius: 100px;
            font-size: 0.65rem;
            font-weight: 700;
            background: rgba(16, 185, 129, 0.15);
            color: var(--accent-green);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .badge-fail {
            display: inline-block;
            padding: 0.15rem 0.5rem;
            border-radius: 100px;
            font-size: 0.65rem;
            font-weight: 700;
            background: rgba(239, 68, 68, 0.15);
            color: var(--accent-red);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .grade-A {
            color: var(--accent-green);
            font-weight: 700;
        }

        .grade-B {
            color: var(--accent-cyan);
            font-weight: 700;
        }

        .grade-C {
            color: var(--accent-amber);
            font-weight: 700;
        }

        .grade-D {
            color: var(--accent-red);
            font-weight: 700;
        }

        /* Quantum Insight Panel */
        .quantum-insight {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.08), rgba(6, 182, 212, 0.05));
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: var(--radius-xl);
            padding: 2.5rem;
            margin-bottom: 2rem;
        }

        .qi-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .qi-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .qi-header h2 {
            font-size: 1.3rem;
            font-weight: 800;
        }

        .qi-header p {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .qi-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .qi-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .qi-item h4 {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .qi-item p {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .qi-item .qi-score {
            font-family: var(--font-mono);
            font-size: 2rem;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .qi-item ul {
            list-style: none;
            padding: 0;
        }

        .qi-item ul li {
            padding: 0.3rem 0;
            padding-left: 1.25rem;
            position: relative;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .qi-item ul li::before {
            content: '‚öõ';
            position: absolute;
            left: 0;
        }

        /* Findings Cards */
        .findings-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .finding-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            transition: var(--transition);
        }

        .finding-card:hover {
            border-color: var(--border-hover);
            transform: translateY(-2px);
        }

        .finding-card h4 {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .finding-card p {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .finding-card .stat-highlight {
            font-family: var(--font-mono);
            font-weight: 700;
            color: var(--accent-cyan);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .kpi-row {
                grid-template-columns: repeat(3, 1fr);
            }

            .qi-grid {
                grid-template-columns: 1fr;
            }

            .findings-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .kpi-row {
                grid-template-columns: repeat(2, 1fr);
            }

            .chart-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="bg-grid"></div>
    <div class="bg-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
    </div>

    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-brand">
            <div class="brand-icon">
                <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                    <circle cx="14" cy="14" r="12" stroke="url(#grad1)" stroke-width="2" />
                    <circle cx="14" cy="14" r="3" fill="url(#grad1)" />
                    <defs>
                        <linearGradient id="grad1" x1="0" y1="0" x2="28" y2="28">
                            <stop offset="0%" stop-color="#8b5cf6" />
                            <stop offset="100%" stop-color="#06b6d4" />
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <span class="brand-name">Quantum<span class="brand-accent">Ready</span></span>
        </div>
        <div class="nav-links">
            <a href="index.html" class="nav-link">‚Üê Back to Analyzer</a>
            <a href="#quantum-insight" class="nav-link">Quantum Insight</a>
            <a href="#data" class="nav-link">Raw Data</a>
        </div>
    </nav>

    <main class="analysis-page">
        <a href="index.html" class="back-link">‚Üê Back to Quantum Readiness Analyzer</a>

        <div class="page-header">
            <div class="section-tag">Live Case Study</div>
            <h1>Amul Milk Quality ‚Äî <span class="gradient-text">Coliform Analysis</span></h1>
            <p>Real-world dairy contamination data analyzed through a quantum computing lens. 60 samples across 10
                Gujarat collection centers, 2025.</p>
        </div>

        <!-- KPI Row -->
        <div class="kpi-row" id="kpiRow">
            <div class="kpi-card">
                <div class="kpi-value info" id="kpiTotal">‚Äî</div>
                <div class="kpi-label">Total Samples</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value danger" id="kpiFail">‚Äî</div>
                <div class="kpi-label">Failed FSSAI</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value warning" id="kpiAvgColiform">‚Äî</div>
                <div class="kpi-label">Avg Coliform CFU/mL</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value danger" id="kpiEcoli">‚Äî</div>
                <div class="kpi-label">E.coli Detected</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value success" id="kpiGradeA">‚Äî</div>
                <div class="kpi-label">Grade A Samples</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-value purple" id="kpiAntibiotic">‚Äî</div>
                <div class="kpi-label">Antibiotic +ve</div>
            </div>
        </div>

        <!-- Key Findings -->
        <div class="findings-grid">
            <div class="finding-card">
                <h4>üå°Ô∏è Temperature-Contamination Link</h4>
                <p>Samples with transport temp ><span class="stat-highlight"> 8¬∞C</span> show <span
                        class="stat-highlight">4.7x higher</span> coliform counts. Cold chain failure is the #1
                    contamination driver.</p>
            </div>
            <div class="finding-card">
                <h4>‚òÄÔ∏è Seasonal Variation</h4>
                <p>Summer months (Apr-Jun) show <span class="stat-highlight">3.2x increase</span> in contamination vs
                    winter. Monsoon adds humidity-driven pathogen growth.</p>
            </div>
            <div class="finding-card">
                <h4>üè≠ Worst Performing Centers</h4>
                <p>Vadodara Collection & Junagadh Center have <span class="stat-highlight">70%+ failure rate</span>.
                    Both have longest transport times (>4 hrs average).</p>
            </div>
        </div>

        <!-- Charts -->
        <div class="chart-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <h3>Coliform Count by Collection Center</h3>
                    <span class="chart-badge">Critical Insight</span>
                </div>
                <div class="chart-body">
                    <canvas id="chartCenterColiform"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3>Seasonal Contamination Trend</h3>
                    <span class="chart-badge">Pattern</span>
                </div>
                <div class="chart-body">
                    <canvas id="chartSeasonalTrend"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3>Transport Temp vs Coliform Count</h3>
                    <span class="chart-badge">Correlation</span>
                </div>
                <div class="chart-body">
                    <canvas id="chartTempCorrelation"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3>FSSAI Grade Distribution</h3>
                    <span class="chart-badge">Quality</span>
                </div>
                <div class="chart-body">
                    <canvas id="chartGradeDistribution"></canvas>
                </div>
            </div>
            <div class="chart-card full-width">
                <div class="chart-header">
                    <h3>Coliform & E.coli Timeline (All Samples)</h3>
                    <span class="chart-badge">Time Series</span>
                </div>
                <div class="chart-body">
                    <canvas id="chartTimeline"></canvas>
                </div>
            </div>
        </div>

        <!-- Quantum Computing Insight Panel -->
        <div class="quantum-insight" id="quantum-insight">
            <div class="qi-header">
                <div class="qi-icon">‚öõÔ∏è</div>
                <div>
                    <h2>Quantum Computing Analysis: <span class="gradient-text">Can Quantum Help?</span></h2>
                    <p>How quantum computing applies to dairy pathogen detection and milk safety optimization</p>
                </div>
            </div>

            <div class="qi-grid">
                <div class="qi-item">
                    <h4>üéØ Quantum Suitability Score</h4>
                    <div class="qi-score">78/100</div>
                    <p><strong>Strong Quantum Potential.</strong> Dairy contamination analysis involves molecular
                        simulation, supply chain optimization, and pattern detection ‚Äî all strong quantum use cases.</p>
                </div>
                <div class="qi-item">
                    <h4>üß™ Molecular Simulation (Score: 95)</h4>
                    <p>Simulating E. coli membrane protein interactions with milk components is exponentially complex
                        classically. Quantum computers can:</p>
                    <ul>
                        <li>Model E. coli O157:H7 toxin binding mechanisms</li>
                        <li>Simulate antibiotic resistance gene expression</li>
                        <li>Design novel antimicrobial peptides for milk preservation</li>
                        <li>Model biofilm formation in dairy equipment</li>
                    </ul>
                </div>
                <div class="qi-item">
                    <h4>üöõ Supply Chain Optimization (Score: 82)</h4>
                    <p>Optimizing cold chain logistics across 10+ centers with 60+ variables is a combinatorial problem
                        where quantum excels:</p>
                    <ul>
                        <li>Optimal route planning to minimize transport time</li>
                        <li>Dynamic temperature control resource allocation</li>
                        <li>Real-time contamination risk routing</li>
                        <li>Multi-center collection scheduling (QAOA)</li>
                    </ul>
                </div>
                <div class="qi-item">
                    <h4>üìä What Quantum Can Solve Today</h4>
                    <p><strong>Near-term (NISQ era, 2025-2028):</strong></p>
                    <ul>
                        <li>Quantum-inspired optimization for cold chain</li>
                        <li>Hybrid quantum-classical ML for contamination prediction</li>
                        <li>Small molecule simulation for preservative design</li>
                    </ul>
                    <p style="margin-top: 0.5rem;"><strong>Medium-term (2028-2032):</strong></p>
                    <ul>
                        <li>Full E. coli protein simulation (100+ qubits)</li>
                        <li>Drug-resistant pathogen modeling</li>
                        <li>National-scale dairy supply chain optimization</li>
                    </ul>
                </div>
                <div class="qi-item">
                    <h4>üíª Classical Alternatives (Use Now)</h4>
                    <p>While waiting for quantum advantage, these work today:</p>
                    <ul>
                        <li>GPU-accelerated Molecular Dynamics (GROMACS)</li>
                        <li>Graph Neural Networks for contamination prediction</li>
                        <li>Classical optimization (Gurobi) for cold chain</li>
                        <li>LSTM/Transformer models for time-series prediction</li>
                    </ul>
                </div>
                <div class="qi-item">
                    <h4>üí∞ ROI for Amul-Scale Dairy</h4>
                    <p><strong>Current contamination cost estimate:</strong></p>
                    <ul>
                        <li>~30% samples at risk ‚Üí ‚Çπ200+ Cr annual waste</li>
                        <li>Cold chain optimization ‚Üí 15-25% reduction possible</li>
                        <li>Molecular antimicrobial design ‚Üí novel preservation</li>
                        <li>Quantum ROI timeline: 3-5 years for full advantage</li>
                    </ul>
                    <p style="margin-top: 0.5rem; color: var(--accent-green); font-weight: 600;">Estimated savings:
                        ‚Çπ50-80 Cr/year with quantum-optimized supply chain</p>
                </div>
                <div class="qi-item"
                    style="grid-column: 1 / -1; background: rgba(139, 92, 246, 0.1); border-color: rgba(139, 92, 246, 0.4); text-align: center;">
                    <h4 style="justify-content: center;">üöÄ Live Quantum Demo</h4>
                    <p>Don't just read about it. Run a live <strong>3-Qubit Grover's Search</strong> simulation to
                        identify a contaminated batch using quantum logic.</p>
                    <a href="quantum-demo.html" class="btn btn-primary"
                        style="margin-top: 1rem; display: inline-flex;">Launch Quantum Simulator ‚Üí</a>
                </div>
            </div>
        </div>

        <!-- Data Table -->
        <div class="data-table-container" id="data">
            <div class="table-header">
                <h3>üìã Raw Sample Data ‚Äî Amul Gujarat Network</h3>
                <div class="table-controls">
                    <select class="table-filter" id="filterGrade" onchange="filterTable()">
                        <option value="all">All Grades</option>
                        <option value="A">Grade A</option>
                        <option value="B">Grade B</option>
                        <option value="C">Grade C</option>
                        <option value="D">Grade D</option>
                    </select>
                    <select class="table-filter" id="filterResult" onchange="filterTable()">
                        <option value="all">All Results</option>
                        <option value="Pass">Pass Only</option>
                        <option value="Fail">Fail Only</option>
                    </select>
                    <select class="table-filter" id="filterSeason" onchange="filterTable()">
                        <option value="all">All Seasons</option>
                        <option value="Winter">Winter</option>
                        <option value="Spring">Spring</option>
                        <option value="Summer">Summer</option>
                        <option value="Monsoon">Monsoon</option>
                        <option value="Autumn">Autumn</option>
                    </select>
                </div>
            </div>
            <div class="table-scroll">
                <table class="data-table" id="dataTable">
                    <thead>
                        <tr>
                            <th>Sample ID</th>
                            <th>Center</th>
                            <th>Date</th>
                            <th>Season</th>
                            <th>Transport Temp</th>
                            <th>Time (hrs)</th>
                            <th>Coliform CFU/mL</th>
                            <th>E.coli CFU/mL</th>
                            <th>pH</th>
                            <th>Grade</th>
                            <th>Result</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- CTA -->
        <div style="text-align: center; padding: 2rem 0;">
            <a href="index.html" class="btn btn-primary btn-lg">
                ‚öõÔ∏è Run Full Quantum Readiness Assessment ‚Üí
            </a>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-bottom">
            <p>¬© 2026 QuantumReady ‚Äî Amul Milk Quality Analysis Demo. Data simulated for demonstration.</p>
        </div>
    </footer>

    <script>
        // ===== Load and Parse CSV =====
        let allData = [];

        async function loadData() {
            const response = await fetch('data/amul_milk_quality.csv');
            const text = await response.text();
            const lines = text.trim().split('\n');
            const headers = lines[0].split(',');

            allData = lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                headers.forEach((h, i) => obj[h.trim()] = values[i]?.trim());
                return obj;
            });

            updateKPIs();
            buildTable(allData);
            buildCharts();
        }

        // ===== KPIs =====
        function updateKPIs() {
            const total = allData.length;
            const failed = allData.filter(d => d.Pass_Fail === 'Fail').length;
            const avgColiform = Math.round(allData.reduce((s, d) => s + parseInt(d.Coliform_CFU_mL), 0) / total);
            const ecoliDetected = allData.filter(d => parseInt(d.Ecoli_CFU_mL) > 0).length;
            const gradeA = allData.filter(d => d.FSSAI_Grade === 'A').length;
            const antibioticPos = allData.filter(d => d.Antibiotic_Residue === 'Positive').length;

            animateKPI('kpiTotal', total);
            animateKPI('kpiFail', failed);
            animateKPI('kpiAvgColiform', avgColiform);
            animateKPI('kpiEcoli', ecoliDetected);
            animateKPI('kpiGradeA', gradeA);
            animateKPI('kpiAntibiotic', antibioticPos);
        }

        function animateKPI(id, target) {
            const el = document.getElementById(id);
            let current = 0;
            const duration = 1200;
            const start = performance.now();
            function update(now) {
                const progress = Math.min((now - start) / duration, 1);
                const eased = 1 - Math.pow(1 - progress, 3);
                el.textContent = Math.floor(target * eased).toLocaleString();
                if (progress < 1) requestAnimationFrame(update);
            }
            requestAnimationFrame(update);
        }

        // ===== Table =====
        function buildTable(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = data.map(d => `
            <tr>
                <td>${d.Sample_ID}</td>
                <td>${d.Collection_Center}</td>
                <td>${d.Date}</td>
                <td>${d.Season}</td>
                <td>${parseFloat(d.Transport_Temp_C).toFixed(1)}¬∞C</td>
                <td>${d.Time_To_Lab_Hrs}</td>
                <td style="color: ${parseInt(d.Coliform_CFU_mL) > 100 ? '#ef4444' : parseInt(d.Coliform_CFU_mL) > 50 ? '#f59e0b' : '#10b981'}; font-weight: 700;">${parseInt(d.Coliform_CFU_mL).toLocaleString()}</td>
                <td style="color: ${parseInt(d.Ecoli_CFU_mL) > 0 ? '#ef4444' : '#10b981'}; font-weight: 600;">${d.Ecoli_CFU_mL}</td>
                <td>${d.pH}</td>
                <td class="grade-${d.FSSAI_Grade}">${d.FSSAI_Grade}</td>
                <td>${d.Pass_Fail === 'Pass' ? '<span class="badge-pass">PASS</span>' : '<span class="badge-fail">FAIL</span>'}</td>
            </tr>
        `).join('');
        }

        function filterTable() {
            const grade = document.getElementById('filterGrade').value;
            const result = document.getElementById('filterResult').value;
            const season = document.getElementById('filterSeason').value;

            let filtered = allData;
            if (grade !== 'all') filtered = filtered.filter(d => d.FSSAI_Grade === grade);
            if (result !== 'all') filtered = filtered.filter(d => d.Pass_Fail === result);
            if (season !== 'all') filtered = filtered.filter(d => d.Season === season);
            buildTable(filtered);
        }

        // ===== Charts =====
        const chartColors = {
            purple: 'rgba(139, 92, 246, 0.8)',
            purpleFill: 'rgba(139, 92, 246, 0.15)',
            cyan: 'rgba(6, 182, 212, 0.8)',
            cyanFill: 'rgba(6, 182, 212, 0.15)',
            red: 'rgba(239, 68, 68, 0.8)',
            redFill: 'rgba(239, 68, 68, 0.15)',
            green: 'rgba(16, 185, 129, 0.8)',
            amber: 'rgba(245, 158, 11, 0.8)',
            pink: 'rgba(236, 72, 153, 0.8)',
        };

        const chartDefaults = {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    labels: { color: '#a0a0b0', font: { family: 'Inter', size: 11 } }
                }
            },
            scales: {
                x: {
                    ticks: { color: '#6b6b80', font: { family: 'Inter', size: 10 } },
                    grid: { color: 'rgba(255,255,255,0.04)' }
                },
                y: {
                    ticks: { color: '#6b6b80', font: { family: 'Inter', size: 10 } },
                    grid: { color: 'rgba(255,255,255,0.04)' }
                }
            }
        };

        function buildCharts() {
            buildCenterChart();
            buildSeasonalChart();
            buildTempCorrelation();
            buildGradeDistribution();
            buildTimeline();
        }

        function buildCenterChart() {
            const centers = {};
            allData.forEach(d => {
                if (!centers[d.Collection_Center]) centers[d.Collection_Center] = [];
                centers[d.Collection_Center].push(parseInt(d.Coliform_CFU_mL));
            });

            const labels = Object.keys(centers).map(c => c.replace(' Coop', '').replace(' Collection', '').replace(' Hub', '').replace(' Milk Union', '').replace(' Center', '').replace(' Dairy', ''));
            const avgData = Object.values(centers).map(arr => Math.round(arr.reduce((a, b) => a + b, 0) / arr.length));
            const maxData = Object.values(centers).map(arr => Math.max(...arr));

            new Chart(document.getElementById('chartCenterColiform'), {
                type: 'bar',
                data: {
                    labels,
                    datasets: [
                        { label: 'Avg Coliform', data: avgData, backgroundColor: chartColors.purple, borderRadius: 6, barPercentage: 0.6 },
                        { label: 'Max Coliform', data: maxData, backgroundColor: chartColors.redFill, borderColor: chartColors.red, borderWidth: 1, borderRadius: 6, barPercentage: 0.6 }
                    ]
                },
                options: {
                    ...chartDefaults,
                    plugins: {
                        ...chartDefaults.plugins,
                        annotation: { annotations: { line1: { type: 'line', yMin: 100, yMax: 100, borderColor: '#ef4444', borderWidth: 2, borderDash: [5, 5], label: { content: 'FSSAI Limit', enabled: true } } } }
                    }
                }
            });
        }

        function buildSeasonalChart() {
            const seasons = ['Winter', 'Spring', 'Summer', 'Monsoon', 'Autumn'];
            const seasonData = seasons.map(s => {
                const items = allData.filter(d => d.Season === s);
                return {
                    avg: Math.round(items.reduce((sum, d) => sum + parseInt(d.Coliform_CFU_mL), 0) / (items.length || 1)),
                    ecoli: Math.round(items.reduce((sum, d) => sum + parseInt(d.Ecoli_CFU_mL), 0) / (items.length || 1)),
                    failRate: Math.round((items.filter(d => d.Pass_Fail === 'Fail').length / (items.length || 1)) * 100)
                };
            });

            new Chart(document.getElementById('chartSeasonalTrend'), {
                type: 'bar',
                data: {
                    labels: seasons,
                    datasets: [
                        { label: 'Avg Coliform CFU/mL', data: seasonData.map(s => s.avg), backgroundColor: [chartColors.cyan, chartColors.green, chartColors.red, chartColors.amber, chartColors.purple], borderRadius: 6, barPercentage: 0.5 },
                        { label: 'Fail Rate %', data: seasonData.map(s => s.failRate), type: 'line', borderColor: chartColors.red, backgroundColor: chartColors.redFill, fill: true, tension: 0.4, yAxisID: 'y1' }
                    ]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        ...chartDefaults.scales,
                        y1: { position: 'right', ticks: { color: '#6b6b80', font: { family: 'Inter', size: 10 }, callback: v => v + '%' }, grid: { display: false }, max: 100 }
                    }
                }
            });
        }

        function buildTempCorrelation() {
            const scatterData = allData.map(d => ({
                x: parseFloat(d.Transport_Temp_C),
                y: parseInt(d.Coliform_CFU_mL)
            }));

            new Chart(document.getElementById('chartTempCorrelation'), {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Temp vs Coliform',
                        data: scatterData,
                        backgroundColor: scatterData.map(d => d.y > 100 ? chartColors.red : d.y > 50 ? chartColors.amber : chartColors.green),
                        pointRadius: 6,
                        pointHoverRadius: 9
                    }]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        x: { ...chartDefaults.scales.x, title: { display: true, text: 'Transport Temperature (¬∞C)', color: '#a0a0b0', font: { family: 'Inter' } } },
                        y: { ...chartDefaults.scales.y, title: { display: true, text: 'Coliform CFU/mL', color: '#a0a0b0', font: { family: 'Inter' } } }
                    }
                }
            });
        }

        function buildGradeDistribution() {
            const grades = { A: 0, B: 0, C: 0, D: 0 };
            allData.forEach(d => { if (grades.hasOwnProperty(d.FSSAI_Grade)) grades[d.FSSAI_Grade]++; });

            new Chart(document.getElementById('chartGradeDistribution'), {
                type: 'doughnut',
                data: {
                    labels: ['Grade A (Excellent)', 'Grade B (Good)', 'Grade C (Acceptable)', 'Grade D (Poor)'],
                    datasets: [{
                        data: Object.values(grades),
                        backgroundColor: [chartColors.green, chartColors.cyan, chartColors.amber, chartColors.red],
                        borderWidth: 0,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#a0a0b0', font: { family: 'Inter', size: 11 }, padding: 16 }
                        }
                    }
                }
            });
        }

        function buildTimeline() {
            const sorted = [...allData].sort((a, b) => new Date(a.Date) - new Date(b.Date));

            new Chart(document.getElementById('chartTimeline'), {
                type: 'line',
                data: {
                    labels: sorted.map(d => d.Date),
                    datasets: [
                        {
                            label: 'Coliform CFU/mL',
                            data: sorted.map(d => parseInt(d.Coliform_CFU_mL)),
                            borderColor: chartColors.purple,
                            backgroundColor: chartColors.purpleFill,
                            fill: true,
                            tension: 0.3,
                            pointRadius: 3,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'E.coli CFU/mL',
                            data: sorted.map(d => parseInt(d.Ecoli_CFU_mL)),
                            borderColor: chartColors.red,
                            backgroundColor: chartColors.redFill,
                            fill: true,
                            tension: 0.3,
                            pointRadius: 3,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        x: { ...chartDefaults.scales.x, ticks: { ...chartDefaults.scales.x.ticks, maxRotation: 45, maxTicksLimit: 15 } },
                        y: chartDefaults.scales.y
                    }
                }
            });
        }

        // ===== Init =====
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>

</html>